<html>
<head>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
  <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.12.1/js/jquery.dataTables.js"></script>

  <!-- Bootstrap 5 Styling -->
  <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.12.1/js/dataTables.bootstrap5.min.js"></script>
  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.1.3/css/bootstrap.min.css"/>
  <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.12.1/css/dataTables.bootstrap5.min.css"/>

  <script>
          $(document).ready(function () {
              $('#results').DataTable({
                  paging: false
              });
          });
  </script>
</head>

<body>
<div class="container">
  <table id="results" class="table table-bordered table-hover text-nowrap">
    <thead class="table-light">
    <tr>
      <th colspan="7" class="text-center">Combination</th>
      <th colspan="{{(hashes|length)}}" class="text-center">ESMF Tested Hash</th>
    </tr>
    <tr>
      <th>Machine</th>
      <th>Compiler</th>
      <th>Version</th>
      <th>MPI</th>
      <th>Version</th>
      <th>BOPT</th>
      <th>NetCDF</th>
      {# for n in range(3) #}
      {% for h in hashes %}
      <th>{{h.esmf_hash}}</th>
      {% endfor %}
      {# endfor #}
    </tr>
    </thead>
    <tbody>
    {% for c in combos %}
      <tr>
        <td>{{c.machine}}</td>
        <td>{{c.compiler}}</td>
        <td>{{c.compiler_ver}}</td>
        <td>{{c.mpi}}</td>
        <td>{{c.mpi_ver}}</td>
        <td>{{c.bopt}}</td>
        <td>{{c.netcdf}}</td>
        {# for n in range(3) #}
        {% set comboloop = loop %}
        {% for r in result_rows[comboloop.index0] %}
        {% if r.build == "FAIL" %}
          {% set cls = "table-danger" %}
        {% elif r.build == "PASS" %}
          {% set cls = "table-success" %}
        {% endif %}
        <td class="{{cls}}" data-bs-toggle="tooltip" title="{{r.esmf_hash}}"></td>
        {% endfor %}
        {# endfor #}
    {% endfor %}
    </tbody>
  </table>
</div>
</body>

</html>